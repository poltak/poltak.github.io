import{b as U,a as k}from"../chunks/3wy9VqJr.js";import"../chunks/pjcxXySh.js";import{aC as je,bc as re,bd as ye,aE as r,x as we,v as S,g as e,aD as Ce,j as ke,o,d as oe,R as c,C as a,aH as Se,w as D,q as l,be as Oe,bf as Ue}from"../chunks/DEdbc7eF.js";import{s as m}from"../chunks/C8FaYV1O.js";import{i as V}from"../chunks/CeRQR2up.js";import{h as Ee}from"../chunks/DIdsJkK3.js";import{s as le,r as $e}from"../chunks/CzaEsoBq.js";import{s as O}from"../chunks/DyJr5tD7.js";import{e as j}from"../chunks/B2bP0puB.js";import{b as Ne,a as Me}from"../chunks/B_BqdAm4.js";import{b as Re}from"../chunks/aEJhf3-I.js";import{i as Fe}from"../chunks/4qslejAf.js";import{p as Je}from"../chunks/-fCvwRfS.js";const Ke=()=>({fun:{title:"Kindle Clippings Converter",description:'Upload your Kindle "My Clippings.txt" file and export your highlights as CSV or JSON, ready for spreadsheets, Notion, or further processing.'}}),rt=Object.freeze(Object.defineProperty({__proto__:null,load:Ke},Symbol.toStringTag,{value:"Module"})),Le=["title","author","type","location_start","location_end","page_start","page_end","added_on","content","raw_metadata"];function Te(v){return/[",\n\r]/.test(v)?`"${v.replace(/"/g,'""')}"`:v}function qe(v){const x=[Le.join(",")];for(const t of v){const d=[t.title,t.author??"",t.type,t.locationStart?.toString()??"",t.locationEnd?.toString()??"",t.pageStart?.toString()??"",t.pageEnd?.toString()??"",t.addedOn??"",t.content??"",t.rawMetadata].map(Te);x.push(d.join(","))}return`${x.join(`
`)}
`}function ze(v,x={}){const{pretty:t=!0}=x;return JSON.stringify(v,null,t?2:0)+`
`}var De=U('<p class="file-name svelte-13j1vxx"> </p>'),Ve=U('<div class="alert svelte-13j1vxx"> </div>'),Ae=U('<p class="status svelte-13j1vxx"> </p>'),Be=U(`<p class="viewer-link">Check out my <a href="./kindle-highlights-viewer">Kindle Clippings Viewer</a> page if you want to browse through your clippings in a simple interface.</p> <p class="note svelte-13j1vxx">Built on my <a href="https://www.npmjs.com/package/kindle-highlights-parser" target="_blank" rel="noopener noreferrer" class="svelte-13j1vxx">kindle-highlights-parser</a> package.</p> <section class="card svelte-13j1vxx"><h2>1. Upload your file</h2> <div class="upload-panel svelte-13j1vxx"><label class="file-input svelte-13j1vxx" for="clippings"><input id="clippings" type="file" accept=".txt" class="svelte-13j1vxx"/> <span>Choose &quot;My Clippings.txt&quot;</span></label> <!> <p class="hint svelte-13j1vxx">Your file never leaves the browser. Everything stays local.</p></div> <!></section> <section class="card svelte-13j1vxx"><h2>2. Choose output</h2> <p class="note svelte-13j1vxx">Feel free to <a href="/contact" class="svelte-13j1vxx">contact me</a> if you need a different output format.</p> <div class="controls svelte-13j1vxx"><div class="toggle-group svelte-13j1vxx" role="group" aria-label="Output format"><button type="button">CSV</button> <button type="button">JSON</button></div> <label><input type="checkbox"/> Pretty JSON</label> <button type="button" class="ghost svelte-13j1vxx">Reset</button></div> <div class="summary svelte-13j1vxx"><div><span class="label svelte-13j1vxx">Clippings parsed</span> <span class="value svelte-13j1vxx"> </span></div> <div><span class="label svelte-13j1vxx">Output format</span> <span class="value svelte-13j1vxx"> </span></div></div></section> <section class="card output-card svelte-13j1vxx"><div class="output-header svelte-13j1vxx"><h2>3. Export</h2> <div class="actions svelte-13j1vxx"><button type="button" class="svelte-13j1vxx">Copy</button> <a rel="noopener noreferrer">Download</a></div></div> <!> <textarea class="output svelte-13j1vxx" readonly="" placeholder="Upload a file to see the output here.">
    </textarea></section>`,1);function ot(v,x){je(x,!1);let t=c("csv"),d=c(!0),n=c([]),p=c(""),y=c(""),h=c(null),g=c(""),_=c(""),f=c(""),b=c(null);function ne(){return`${e(f)?e(f).replace(/\.txt$/i,"").replace(/\s+/g,"-").toLowerCase():"kindle-clippings"}.${e(t)}`}async function ie(s){const u=s.currentTarget.files?.[0];if(a(_,""),a(g,""),!u){a(n,[]),a(f,"");return}a(f,u.name);try{const C=await u.text(),me=Je(C);a(n,me.normalized),e(n).length===0&&a(g,'No clippings found. Check that this is a Kindle "My Clippings.txt" file.')}catch(C){a(n,[]),a(g,C instanceof Error?C.message:"Something went wrong while parsing the file.")}}function pe(){if(e(n).length===0){a(p,""),a(y,"");return}a(p,e(t)==="csv"?qe(e(n)):ze(e(n),{pretty:e(d)})),a(y,ne())}async function ce(){if(e(p))try{await navigator.clipboard.writeText(e(p)),a(_,"Copied to clipboard.")}catch(s){a(_,s instanceof Error?s.message:"Unable to copy output to clipboard.")}}function ve(){a(n,[]),a(p,""),a(y,""),a(g,""),a(_,""),a(f,""),e(b)&&Ue(b,e(b).value="")}re(()=>(e(n),e(t),e(d)),()=>{e(n),e(t),e(d),pe()}),re(()=>(e(h),e(p),e(t)),()=>{typeof window<"u"&&(e(h)&&URL.revokeObjectURL(e(h)),a(h,e(p)?URL.createObjectURL(new Blob([e(p)],{type:e(t)==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"})):null))}),ye(),Fe();var A=Be();Ee("13j1vxx",s=>{ke(()=>{Se.title="Kindle Clippings Converter"})});var E=r(we(A),4),$=r(o(E),2),N=o($),B=o(N);Re(B,s=>a(b,s),()=>e(b)),D(2),l(N);var ue=r(N,2);{var de=s=>{var i=De(),u=o(i);l(i),S(()=>m(u,`Selected: ${e(f)??""}`)),k(s,i)};V(ue,s=>{e(f)&&s(de)})}D(2),l($);var fe=r($,2);{var xe=s=>{var i=Ve(),u=o(i,!0);l(i),S(()=>m(u,e(g))),k(s,i)};V(fe,s=>{e(g)&&s(xe)})}l(E);var M=r(E,2),R=r(o(M),4),F=o(R),J=o(F);let H;var P=r(J,2);let I;l(F);var w=r(F,2);let Y;var K=o(w);$e(K),D(),l(w);var he=r(w,2);l(R);var G=r(R,2),L=o(G),Q=r(o(L),2),ge=o(Q,!0);l(Q),l(L);var W=r(L,2),X=r(o(W),2),_e=o(X,!0);l(X),l(W),l(G),l(M);var Z=r(M,2),T=o(Z),ee=r(o(T),2),q=o(ee),z=r(q,2);let te;l(ee),l(T);var ae=r(T,2);{var be=s=>{var i=Ae(),u=o(i,!0);l(i),S(()=>m(u,e(_))),k(s,i)};V(ae,s=>{e(_)&&s(be)})}var se=r(ae,2);Oe(se),l(Z),S(s=>{H=O(J,1,"svelte-13j1vxx",null,H,{active:e(t)==="csv"}),I=O(P,1,"svelte-13j1vxx",null,I,{active:e(t)==="json"}),Y=O(w,1,"checkbox svelte-13j1vxx",null,Y,{disabled:e(t)!=="json"}),K.disabled=e(t)!=="json",m(ge,(e(n),oe(()=>e(n).length))),m(_e,s),q.disabled=!e(p),le(z,"href",e(h)??"#"),le(z,"download",e(y)),te=O(z,1,"svelte-13j1vxx",null,te,{disabled:!e(h)})},[()=>(e(t),oe(()=>e(t).toUpperCase()))]),j("change",B,ie),j("click",J,()=>a(t,"csv")),j("click",P,()=>a(t,"json")),Ne(K,()=>e(d),s=>a(d,s)),j("click",he,ve),j("click",q,ce),Me(se,()=>e(p),s=>a(p,s)),k(v,A),Ce()}export{ot as component,rt as universal};
