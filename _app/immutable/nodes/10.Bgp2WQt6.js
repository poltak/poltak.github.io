import{t as O,a as k}from"../chunks/CXnjyUtD.js";import"../chunks/CL7t4_dr.js";import{aq as he,aH as te,aI as _e,at as l,ap as me,ar as S,j as e,as as be,ay as qe,au as r,F as we,aJ as u,q as t,aw as V,av as o,aK as xe}from"../chunks/Dyuul76F.js";import{e as q,s as w}from"../chunks/MxA1b9NE.js";import{i as A}from"../chunks/DN3lzGhq.js";import{h as Ce}from"../chunks/CHjvqQKf.js";import{s as ae,r as ke}from"../chunks/aHW3g2Pa.js";import{t as j}from"../chunks/BWGAlAvk.js";import{r as Se}from"../chunks/oC0sKxxq.js";import{b as je,a as Oe}from"../chunks/THN5qdqg.js";import{b as Ue}from"../chunks/DGhhXaDl.js";import{i as $e}from"../chunks/UvqdDaAr.js";import{p as Ee}from"../chunks/-fCvwRfS.js";const Ne=()=>({fun:{title:"Kindle Clippings Converter",description:'Upload your Kindle "My Clippings.txt" file and export your highlights as CSV or JSON, ready for spreadsheets, Notion, or further processing.'}}),et=Object.freeze(Object.defineProperty({__proto__:null,load:Ne},Symbol.toStringTag,{value:"Module"})),Fe=["title","author","type","location_start","location_end","page_start","page_end","added_on","content","raw_metadata"];function Je(v){return/[",\n\r]/.test(v)?`"${v.replace(/"/g,'""')}"`:v}function Me(v){var s,f,i,c;const h=[Fe.join(",")];for(const n of v){const y=[n.title,n.author??"",n.type,((s=n.locationStart)==null?void 0:s.toString())??"",((f=n.locationEnd)==null?void 0:f.toString())??"",((i=n.pageStart)==null?void 0:i.toString())??"",((c=n.pageEnd)==null?void 0:c.toString())??"",n.addedOn??"",n.content??"",n.rawMetadata].map(Je);h.push(y.join(","))}return`${h.join(`
`)}
`}function Ke(v,h={}){const{pretty:s=!0}=h;return JSON.stringify(v,null,s?2:0)+`
`}var Re=O('<p class="file-name svelte-q14ylc"> </p>'),Le=O('<div class="alert svelte-q14ylc"> </div>'),Te=O('<p class="status svelte-q14ylc"> </p>'),ze=O(`<p class="viewer-link">Check out my <a href="./kindle-highlights-viewer">Kindle Clippings Viewer</a> page if you want to browse through your clippings in a simple interface.</p> <p class="note svelte-q14ylc">Built on my <a href="https://www.npmjs.com/package/kindle-highlights-parser" target="_blank" rel="noopener noreferrer" class="svelte-q14ylc">kindle-highlights-parser</a> package.</p> <section class="card svelte-q14ylc"><h2>1. Upload your file</h2> <div class="upload-panel svelte-q14ylc"><label class="file-input svelte-q14ylc" for="clippings"><input id="clippings" type="file" accept=".txt" class="svelte-q14ylc"> <span>Choose &quot;My Clippings.txt&quot;</span></label> <!> <p class="hint svelte-q14ylc">Your file never leaves the browser. Everything stays local.</p></div> <!></section> <section class="card svelte-q14ylc"><h2>2. Choose output</h2> <p class="note svelte-q14ylc">Feel free to <a href="/contact" class="svelte-q14ylc">contact me</a> if you need a different output format.</p> <div class="controls svelte-q14ylc"><div class="toggle-group svelte-q14ylc" role="group" aria-label="Output format"><button type="button" class="svelte-q14ylc">CSV</button> <button type="button" class="svelte-q14ylc">JSON</button></div> <label class="checkbox svelte-q14ylc"><input type="checkbox"> Pretty JSON</label> <button type="button" class="ghost svelte-q14ylc">Reset</button></div> <div class="summary svelte-q14ylc"><div><span class="label svelte-q14ylc">Clippings parsed</span> <span class="value svelte-q14ylc"> </span></div> <div><span class="label svelte-q14ylc">Output format</span> <span class="value svelte-q14ylc"> </span></div></div></section> <section class="card output-card svelte-q14ylc"><div class="output-header svelte-q14ylc"><h2>3. Export</h2> <div class="actions svelte-q14ylc"><button type="button" class="svelte-q14ylc">Copy</button> <a rel="noopener noreferrer" class="svelte-q14ylc">Download</a></div></div> <!> <textarea class="output svelte-q14ylc" readonly="" placeholder="Upload a file to see the output here.">
    </textarea></section>`,1);function tt(v,h){he(h,!1);let s=u("csv"),f=u(!0),i=u([]),c=u(""),n=u(""),y=u(null),_=u(""),m=u(""),g=u(""),b=u(null);function se(){return`${e(g)?e(g).replace(/\.txt$/i,"").replace(/\s+/g,"-").toLowerCase():"kindle-clippings"}.${e(s)}`}async function le(a){var ee;const d=(ee=a.currentTarget.files)==null?void 0:ee[0];if(t(m,""),t(_,""),!d){t(i,[]),t(g,"");return}t(g,d.name);try{const C=await d.text(),ge=Ee(C);t(i,ge.normalized),e(i).length===0&&t(_,'No clippings found. Check that this is a Kindle "My Clippings.txt" file.')}catch(C){t(i,[]),t(_,C instanceof Error?C.message:"Something went wrong while parsing the file.")}}function re(){if(e(i).length===0){t(c,""),t(n,"");return}t(c,e(s)==="csv"?Me(e(i)):Ke(e(i),{pretty:e(f)})),t(n,se())}async function oe(){if(e(c))try{await navigator.clipboard.writeText(e(c)),t(m,"Copied to clipboard.")}catch(a){t(m,a instanceof Error?a.message:"Unable to copy output to clipboard.")}}function ne(){t(i,[]),t(c,""),t(n,""),t(_,""),t(m,""),t(g,""),e(b)&&xe(b,e(b).value="")}te(()=>(e(i),e(s),e(f)),()=>{e(i),e(s),e(f),re()}),te(()=>(e(y),e(c),e(s)),()=>{typeof window<"u"&&(e(y)&&URL.revokeObjectURL(e(y)),t(y,e(c)?URL.createObjectURL(new Blob([e(c)],{type:e(s)==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"})):null))}),_e(),$e();var B=ze();Ce(a=>{qe.title="Kindle Clippings Converter"});var U=l(me(B),4),$=l(r(U),2),E=r($),D=r(E);Ue(D,a=>t(b,a),()=>e(b)),V(2),o(E);var ie=l(E,2);{var ce=a=>{var p=Re(),d=r(p);o(p),S(()=>w(d,`Selected: ${e(g)??""}`)),k(a,p)};A(ie,a=>{e(g)&&a(ce)})}V(2),o($);var pe=l($,2);{var ue=a=>{var p=Le(),d=r(p,!0);o(p),S(()=>w(d,e(_))),k(a,p)};A(pe,a=>{e(_)&&a(ue)})}o(U);var N=l(U,2),F=l(r(N),4),J=r(F),M=r(J),H=l(M,2);o(J);var x=l(J,2),K=r(x);ke(K),V(),o(x);var ve=l(x,2);o(F);var I=l(F,2),R=r(I),P=l(r(R),2),de=r(P,!0);o(P),o(R);var Y=l(R,2),G=l(r(Y),2),fe=r(G,!0);o(G),o(Y),o(I),o(N);var Q=l(N,2),L=r(Q),W=l(r(L),2),T=r(W),z=l(T,2);o(W),o(L);var X=l(L,2);{var ye=a=>{var p=Te(),d=r(p,!0);o(p),S(()=>w(d,e(m))),k(a,p)};A(X,a=>{e(m)&&a(ye)})}var Z=l(X,2);Se(Z),o(Q),S(a=>{j(M,"active",e(s)==="csv"),j(H,"active",e(s)==="json"),j(x,"disabled",e(s)!=="json"),K.disabled=e(s)!=="json",w(de,e(i).length),w(fe,a),T.disabled=!e(c),ae(z,"href",e(y)??"#"),ae(z,"download",e(n)),j(z,"disabled",!e(y))},[()=>e(s).toUpperCase()],we),q("change",D,le),q("click",M,()=>t(s,"csv")),q("click",H,()=>t(s,"json")),je(K,()=>e(f),a=>t(f,a)),q("click",ve,ne),q("click",T,oe),Oe(Z,()=>e(c),a=>t(c,a)),k(v,B),be()}export{tt as component,et as universal};
